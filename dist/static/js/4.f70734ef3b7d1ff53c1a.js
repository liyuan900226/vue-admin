webpackJsonp([4],{DAJO:function(e,t){},Eht3:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={name:"SwipersAdd",data:function(){return{dialogVisible:!1,areaList:{},formData:{title:"",province:"",city_list:[],begin_time:"",end_time:"",image_url:"",link_url:""},img:"",rules:{title:[{required:!0,message:"请输入活动名称",trigger:"blur"},{min:2,max:15,message:"长度不能超过15个字符",trigger:"blur"}],province:[{required:!0,message:"请至少选择一选项",trigger:"change"}],city_list:[{type:"array",required:!0,message:"请至少选择一选项",trigger:"change"}],user_type:[{required:!0,message:"请选择活动资源",trigger:"change"}]},value7:["",""],fileList3:[{name:"food.jpeg",url:"https://fuss10.elemecdn.com/3/63/4e7f3a15429bfda99bce42a18cdd1jpeg.jpeg?imageMogr2/thumbnail/360x360/format/webp/quality/100"},{name:"food2.jpeg",url:"https://fuss10.elemecdn.com/3/63/4e7f3a15429bfda99bce42a18cdd1jpeg.jpeg?imageMogr2/thumbnail/360x360/format/webp/quality/100"}]}},mounted:function(){this.getAreaList()},methods:{imgDelete:function(){this.formData.image_url=""},formDataUpload:function(){var e=this;return""===this.value7[0]||""===this.value7[1]?(this.$message({message:"请选择活动时间",type:"warning"}),!1):""===this.formData.image_url?(this.$message({message:"请添加一张图片",type:"warning"}),!1):(this.formData.begin_time=Date.parse(e.value7[0])/1e3,this.formData.end_time=Date.parse(e.value7[1])/1e3,void this.baseFun().axios("post",this.baseUrl().banner_add,this.formData,function(t){t.data.success?(e.$message({message:"添加成功！",type:"success"}),e.formData.image_url="",e.$emit("SwiperAdd","aaa")):e.$message({message:"添加成功"+t.data.msg,type:"warning"})}))},beforeUpload:function(e){var t=this;new Promise(function(t,a){var i=window.URL||window.webkitURL,r=new Image;r.onload=function(){648==r.width&&334==r.height?t():a()},r.src=i.createObjectURL(e)}).then(function(){t.img=new FormData,t.img.set("image_file",e,e.name);var a=t;return a.baseFun().axios("post",t.baseUrl().imgUpload,t.img,function(e){a.formData.image_url=e.data.image_url}),e},function(){return t.$message.error("图片尺寸必须是等于或大于648*334!"),Promise.reject()});return!1},getAreaList:function(){var e=this;this.baseFun().axiosGet(this.baseUrl().active_Area,function(t){e.areaList=t.data.area_list,e.formData.province=e.areaList[0].province})},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;t.formDataUpload()})},resetForm:function(e){this.$refs[e].resetFields()}},watch:{"formData.province":{handler:function(e,t){e!==t&&(this.formData.city_list=[])},deep:!0}}},r={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"formData",staticClass:"demo-ruleForm",attrs:{model:e.formData,rules:e.rules,"label-width":"80px"}},[a("el-form-item",{staticStyle:{width:"475px"},attrs:{label:"标题",prop:"title","label-width":""}},[a("el-input",{model:{value:e.formData.title,callback:function(t){e.$set(e.formData,"title",t)},expression:"formData.title"}})],1),e._v(" "),a("div",[a("el-form-item",{attrs:{label:"范围",prop:"province"}},[a("el-radio-group",{model:{value:e.formData.province,callback:function(t){e.$set(e.formData,"province",t)},expression:"formData.province"}},e._l(e.areaList,function(t,i){return a("el-radio",{key:i,attrs:{label:t.province}},[e._v(e._s(t.name))])}))],1),e._v(" "),a("el-form-item",{attrs:{label:"",prop:"city_list"}},e._l(e.areaList,function(t,i){return a("el-checkbox-group",{key:i,model:{value:e.formData.city_list,callback:function(t){e.$set(e.formData,"city_list",t)},expression:"formData.city_list"}},[t.province===e.formData.province?a("div",e._l(t.city_list,function(t,i){return a("el-checkbox",{key:i,attrs:{label:t.city,name:"type"}},[e._v(e._s(t.name))])})):e._e()])}))],1),e._v(" "),a("div",[a("div",{staticClass:"block"},[a("span",{staticClass:"demonstration",staticStyle:{"margin-left":"40px","margin-right":"7px"}},[e._v("时间")]),e._v(" "),a("el-date-picker",{attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.value7,callback:function(t){e.value7=t},expression:"value7"}})],1)]),e._v(" "),a("el-row",{staticStyle:{"margin-top":"30px"}},[a("el-col",{attrs:{span:1,offset:1}},[a("span",{staticStyle:{"margin-left":"-9px"}},[e._v("图片 ")])]),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-upload",{staticClass:"upload-demo",attrs:{drag:"",accept:".jpg,.jpeg,.bmp,.gif,.png",action:"https://jsonplaceholder.typicode.com/posts/",multiple:"","before-upload":e.beforeUpload}},[a("i",{staticClass:"el-icon-upload"}),e._v(" "),a("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),a("em",[e._v("点击上传")])]),e._v(" "),a("div",{staticClass:"el-upload__text"},[e._v("支持格式：.jpg  .jpeg .bmp .gif .png")]),e._v(" "),a("div",{staticClass:"el-upload__text"},[e._v("图片尺寸：宽648，高334")])])],1),e._v(" "),a("el-col",{staticStyle:{position:"relative"},attrs:{span:10}},[a("img",{staticStyle:{width:"100%"},attrs:{src:e.formData.image_url,alt:""}}),e._v(" "),a("i",{directives:[{name:"show",rawName:"v-show",value:e.formData.image_url,expression:"formData.image_url"}],staticClass:"el-icon-error closeimg",on:{click:e.imgDelete}})])],1),e._v(" "),a("el-form-item",{staticStyle:{width:"475px","margin-top":"20px"},attrs:{label:"跳转链接","label-width":""}},[a("el-input",{model:{value:e.formData.link_url,callback:function(t){e.$set(e.formData,"link_url",t)},expression:"formData.link_url"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForm("formData")}}},[e._v("立即创建")]),e._v(" "),a("el-button",{on:{click:function(t){e.resetForm("formData")}}},[e._v("重置")])],1)],1)],1)},staticRenderFns:[]};var s={name:"swipersModify",props:["formData","value7"],data:function(){return{dialogVisible:!1,areaList:{},img:"",rules:{title:[{required:!0,message:"请输入活动名称",trigger:"blur"},{min:2,max:15,message:"长度不能超过15个字符",trigger:"blur"}],province:[{required:!0,message:"请至少选择一选项",trigger:"change"}],city_list:[{type:"array",required:!0,message:"请至少选择一选项",trigger:"change"}],user_type:[{required:!0,message:"请选择活动资源",trigger:"change"}]}}},mounted:function(){this.getAreaList()},methods:{imgDelete:function(){this.formData.image_url=""},ProvinceChange:function(){this.formData.city_list=[]},formDataUpload:function(){var e=this;return""===this.value7[0]||""===this.value7[1]?(this.$message({message:"请选择活动时间",type:"warning"}),!1):""===this.formData.image_url?(this.$message({message:"请添加一张图片",type:"warning"}),!1):(this.formData.begin_time=Date.parse(e.value7[0])/1e3,this.formData.end_time=Date.parse(e.value7[1])/1e3,void this.baseFun().axios("post",this.baseUrl().banner_Modify,this.formData,function(t){t.data.success?(e.$message({message:"修改成功！",type:"success"}),e.formData.image_url="",e.$emit("SwipersModify","aaa")):e.$message({message:"修改失败"+t.data.msg,type:"warning"})}))},beforeUpload:function(e){var t=this;new Promise(function(t,a){var i=window.URL||window.webkitURL,r=new Image;r.onload=function(){648==r.width&&334==r.height?t():a()},r.src=i.createObjectURL(e)}).then(function(){t.img=new FormData,t.img.set("image_file",e,e.name);var a=t;return a.baseFun().axios("post",t.baseUrl().imgUpload,t.img,function(e){a.formData.image_url=e.data.image_url}),e},function(){return t.$message.error("图片尺寸必须是等于或大于648*334!"),Promise.reject()});return!1},getAreaList:function(){var e=this;this.baseFun().axiosGet(this.baseUrl().active_Area,function(t){e.areaList=t.data.area_list})},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;t.formDataUpload()})},resetForm:function(e){this.$refs[e].resetFields()}},computed:{},watch:{}},l={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"formData",staticClass:"demo-ruleForm",attrs:{model:e.formData,rules:e.rules,"label-width":"80px"}},[a("el-form-item",{staticStyle:{width:"475px"},attrs:{label:"标题",prop:"title","label-width":""}},[a("el-input",{model:{value:e.formData.title,callback:function(t){e.$set(e.formData,"title",t)},expression:"formData.title"}})],1),e._v(" "),a("div",[a("el-form-item",{attrs:{label:"范围",prop:"province"}},[a("el-radio-group",{model:{value:e.formData.province,callback:function(t){e.$set(e.formData,"province",t)},expression:"formData.province"}},e._l(e.areaList,function(t,i){return a("el-radio",{key:i,attrs:{label:t.province},on:{change:e.ProvinceChange}},[e._v(e._s(t.name))])}))],1),e._v(" "),a("el-form-item",{attrs:{label:"",prop:"city_list"}},e._l(e.areaList,function(t,i){return a("el-checkbox-group",{key:i,model:{value:e.formData.city_list,callback:function(t){e.$set(e.formData,"city_list",t)},expression:"formData.city_list"}},[t.province===e.formData.province?a("div",e._l(t.city_list,function(t,i){return a("el-checkbox",{key:i,attrs:{label:t.city,name:"type"}},[e._v(e._s(t.name))])})):e._e()])}))],1),e._v(" "),a("div",[a("div",{staticClass:"block"},[a("span",{staticClass:"demonstration",staticStyle:{"margin-left":"40px","margin-right":"7px"}},[e._v("时间")]),e._v(" "),a("el-date-picker",{attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.value7,callback:function(t){e.value7=t},expression:"value7"}})],1)]),e._v(" "),a("el-row",{staticStyle:{"margin-top":"30px"}},[a("el-col",{attrs:{span:1,offset:1}},[a("span",{staticStyle:{"margin-left":"-9px"}},[e._v("图片 ")])]),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-upload",{staticClass:"upload-demo",attrs:{drag:"",accept:".jpg,.jpeg,.bmp,.gif,.png",action:"https://jsonplaceholder.typicode.com/posts/",multiple:"","before-upload":e.beforeUpload}},[a("i",{staticClass:"el-icon-upload"}),e._v(" "),a("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),a("em",[e._v("点击上传")])]),e._v(" "),a("div",{staticClass:"el-upload__text"},[e._v("支持格式：.jpg  .jpeg .bmp .gif .png")]),e._v(" "),a("div",{staticClass:"el-upload__text"},[e._v("图片尺寸：宽648，高334")])])],1),e._v(" "),a("el-col",{staticStyle:{position:"relative"},attrs:{span:10}},[a("img",{staticStyle:{width:"100%"},attrs:{src:e.formData.image_url,alt:""}}),e._v(" "),a("i",{directives:[{name:"show",rawName:"v-show",value:e.formData.image_url,expression:"formData.image_url"}],staticClass:"el-icon-error closeimg",on:{click:e.imgDelete}})])],1),e._v(" "),a("el-form-item",{staticStyle:{width:"475px","margin-top":"20px"},attrs:{label:"跳转链接","label-width":""}},[a("el-input",{model:{value:e.formData.link_url,callback:function(t){e.$set(e.formData,"link_url",t)},expression:"formData.link_url"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForm("formData")}}},[e._v("立即修改")]),e._v(" "),a("el-button",{on:{click:function(t){e.resetForm("formData")}}},[e._v("重置")])],1)],1)],1)},staticRenderFns:[]};var o={name:"Swipers",components:{SwiperAdd:a("VU/8")(i,r,!1,function(e){a("DAJO")},"data-v-2dca62af",null).exports,SwipersModify:a("VU/8")(s,l,!1,function(e){a("GDcm")},"data-v-7f810c2e",null).exports},data:function(){return{currentPage:1,pagesize:10,tableDataStatus:"",form:{},tableData:[],dialogVisible:!1,dialogVisibleEdit:!1,queryData:{title:"",status:""},formData:{},value7:[]}},mounted:function(){this.getData()},methods:{handleSizeChange:function(e){this.pagesize=e},handleCurrentChange:function(e){this.currentPage=e},SwiperAdd:function(){this.dialogVisible=!1,this.getData()},SwipersModify:function(){this.dialogVisibleEdit=!1,this.freshData()},freshData:function(){"all"===this.tableDataStatus&&this.getData(),"query"===this.tableDataStatus&&this.getQueryData()},getQueryData:function(){var e=this;console.log(this.queryData),this.baseFun().axios("post",this.baseUrl().banner_query,this.queryData,function(t){e.tableData=t.data.table,e.tableDataStatus="query",e.currentPage=1})},getData:function(){var e=this;this.baseFun().axiosGet(this.baseUrl().banner_home,function(t){e.tableData=t.data.table,e.tableDataStatus="all"})},handleEdit:function(e,t){var a=this;this.dialogVisibleEdit=!0,this.baseFun().axiosGet(this.baseUrl().banner_Modify+"?config_id="+t.id,function(e){a.formData=e.data.config_map,a.value7=[new Date(1e3*parseInt(a.formData.begin_time)),new Date(1e3*parseInt(a.formData.end_time))]})},handleDelete:function(e,t){var a=this,i=this;this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.baseFun().axios("post",a.baseUrl().oprationDelete,{config_id:t.id},function(e){!0===e.data.success?(i.$message({message:"删除成功！",type:"success"}),i.freshData()):i.$message({message:"删除失败："+e.data.msg,type:"warning"})})}).catch(function(){a.$message({type:"info",message:"已取消删除"})})},handleClose:function(e){this.$confirm("确认关闭？").then(function(t){e()}).catch(function(e){})},handleCloseEdit:function(e){this.$confirm("确认关闭？").then(function(t){e()}).catch(function(e){})}},computed:{resultNum:function(){return this.tableData.length}}},n={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form",{ref:"queryData",attrs:{model:e.queryData,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"活动名称"}},[a("el-input",{model:{value:e.queryData.title,callback:function(t){e.$set(e.queryData,"title",t)},expression:"queryData.title"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"状态"}},[a("el-radio-group",{model:{value:e.queryData.status,callback:function(t){e.$set(e.queryData,"status",t)},expression:"queryData.status"}},[a("el-radio",{attrs:{label:"0"}},[e._v("全部")]),e._v(" "),a("el-radio",{attrs:{label:"1"}},[e._v("未上线")]),e._v(" "),a("el-radio",{attrs:{label:"2"}},[e._v("进行中")]),e._v(" "),a("el-radio",{attrs:{label:"3"}},[e._v("已下线")]),e._v(" "),a("el-radio",{attrs:{label:"4"}},[e._v("已删除")])],1)],1)],1)],1),e._v(" "),a("el-col",{attrs:{offset:8,span:2}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogVisible=!0}}},[e._v("添加轮播")])],1)],1),e._v(" "),a("el-row",[a("el-col",[a("el-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.getQueryData}},[e._v("搜索")]),e._v(" "),a("span",{staticStyle:{color:"#666666","margin-left":"20px","font-size":"15px"}},[e._v("共"+e._s(e.resultNum)+"条结果")])],1)],1),e._v(" "),a("div",{staticStyle:{"margin-top":"30px"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData.slice((e.currentPage-1)*e.pagesize,e.currentPage*e.pagesize),border:"","default-sort":{prop:"parent_name",order:"descending"}}},[a("el-table-column",{attrs:{prop:"title",label:"标题",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"range",label:"范围",width:"450",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"begin_time",label:"上线时间",sortable:"",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"end_time",label:"下线时间",sortable:"",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{sortable:"",prop:"status",label:"状态",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{disabled:"已删除"===t.row.status,size:"mini"},on:{click:function(a){e.handleEdit(t.$index,t.row)}}},[e._v("修改")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"danger",disabled:"已删除"===t.row.status},on:{click:function(a){e.handleDelete(t.$index,t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("div",{staticStyle:{position:"relative"}},[a("el-pagination",{staticClass:"page_center",attrs:{"current-page":e.currentPage,"page-sizes":[10,20,50,100],"page-size":e.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:e.tableData.length},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"添加轮播",visible:e.dialogVisible,width:"85%","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("SwiperAdd",{on:{SwiperAdd:e.SwiperAdd}}),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("关 闭")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"修改轮播",visible:e.dialogVisibleEdit,width:"85%","before-close":e.handleCloseEdit},on:{"update:visible":function(t){e.dialogVisibleEdit=t}}},[a("SwipersModify",{attrs:{value7:e.value7,formData:e.formData},on:{SwipersModify:e.SwipersModify}}),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogVisibleEdit=!1}}},[e._v("关 闭")])],1)],1)],1)},staticRenderFns:[]};var c=a("VU/8")(o,n,!1,function(e){a("dT1j")},"data-v-2a02ba17",null);t.default=c.exports},GDcm:function(e,t){},dT1j:function(e,t){}});